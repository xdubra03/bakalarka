%=========================================================================
% (c) Michal Bidlo, Bohuslav Křena, 2008

\chapter{Úvod}

Proteíny patria k~základným stavebným prvkom každého živého organizmu. V~ňom sa podieľajú na množstve rôznych funkcií; ako trávenie alebo prenos kyslíka. Tieto rozličné funkcie z~nich robia významný cieľ skúmania. V~dnešnej dobe je snahou najmä vylepšovanie rôznych vlastností s~cieľom vytvoriť hodnotnejšie proteíny pre rôzne oblasti. Touto problematikou sa zaoberá oblasť proteínového inžinierstva.

Jednou z~vlastností, ktorá je u~proteínov veľmi dôležitá, je stabilita. Stabilný proteín je pripravený lepšie zvládať nepriaznivé podmienky svojho okolia, napríklad vydržať vyššiu teplotu alebo rôzne chemické vlastnosti prostredia. Oblasť návrhu a~výroby stabilnejších proteínov je v~dnešnej dobe zaujímavá najmä pre priemysel, napríklad pri výrobe rôznych biotechnológií. Zaujímavou je aj pre farmaceutický priemysel, pretože stabilnejšie proteíny by viedli k~výrobe účinnejších liečiv.

V~proteínoch však dochádza k~mutáciam aminokyselín tvoriacich proteínový reťazec . Mutácie sú predovšetkým dielom evolúcie, ale taktiež sú uskutočňované umelo s~určitým zámerom. Jedna zmena aminokyseliny v~reťazci môže znamenať zmenu stability proteínu v~pozitívnom, ale aj negatívnom zmysle. Preto je snahou predikovať vplyv takýchto zmien. 
V~poslednom období vzniklo množstvo rôznych nástrojov zaoberajúcich sa predikciou vplyvu mutácií na stabilitu, pričom využívajú rôzne prístupy pri predikcií.

Cieľom tejto práce je vytvorenie, otestovanie a~vyhodnotenie predikčného nástroja kombinujúceho viaceré metódy strojového učenia.

Prvé kapitoly teoretickej časti sa zaoberajú proteínmi a~aminokyselinami. Obsahujú informácie o~vlastnostiach proteínov a~aminokyselín. Taktiež vysvetľujú pojem stability a~jej súvis s~mutáciami.

Zvyšné kapitoly teoretickej časti sú venované strojovému učeniu, tzv. ensemble systémom a~existujúcim nástrojom. Táto časť obsahuje základnú klasifikáciu metód strojového učenia spoločne s~podrobnejšou charakteristikou rôznych metód. Časť o~ensemble systémoch vysvetľuje dôvody a~výhody použitia týchto systémov.

Posledná časť je venovaná tvorbe dátovej sady a~samotnej implementácií nástroja. Bližšie sú uvedené parametre mutácie, výber metód strojového učenia, tvorba ensemble systému a~jeho vyhodnotenie v~porovnaní s~inými nástrojmi.


\chapter{Proteíny}

Proteíny (bielkoviny) môžeme charakterizovať ako základné stavebné prvky všetkých živých organizmov. Nie sú však iba stavebnými prvkami bunky, zabezpečujú väčšinu bunečných funkcií. Pochopenie procesu vzniku proteínov a~ich funkcie nachádza široké uplatnenie v~odvetviach ako medicína, poľnohospodárstvo, priemysel a~mnohé ďaľšie. 
V~tejto kapitole sa budem zaoberať základným rozdelením proteínov, procesom ich vzniku z~DNA a~štruktúrou.

\section{Základné rozdelenie proteínov}

Proteíny sú biopolyméry tvorené z~jedného alebo viacerých polypeptidových reťazcov, ktoré je možné chápať ako sekvenciu polymérov aminokyselín navzájom spojených kovalentnou peptidovou väzbou. Proteíny sa skladajú do množstva komplikovaných tvarov a~ich funkcie súvisia s~konkrétnym priestorovým usporiadaním (konformáciou), pričom sa snažia zaujať čo najlepšiu konformáciu z~energetického hľadiska. Konformácia vychádza z~primárnej štruktúry, ktorú je možné chápať ako reťazec aminokyselín v~danom poradí \cite{proteiny}. Podľa funkcie môžeme proteíny rozdeliť do niekoľkých skupín \cite{proteiny}:  
\begin{itemize}
	\item \textbf{Enzýmy:} ich funkciou je katalýza rozpadu a~tvorba kovalentných väzieb. Príkladom môže byť napríklad pepsín, ktorý sa podieľa na odbúraní bielkovín pri trávení.
	\item \textbf{Štruktúrne proteíny:} tvoria základné stavebné jednotky buniek a~tkanív, poskytujú im mechanickú oporu. Príkladom je keratín tvoriaci základnú zložku vlasov a~nechtov.
	\item \textbf{Transportné proteíny:} prenášajú malé molekuly a~ionty v~organizme. Príkladom sú proteín hemoglobín ako nosič kyslíka v~krvnom obehu a~proteín transferrin prenášajúci železo.
	\item \textbf{Pohybové proteíny:} sú pôvodcami pohybu buniek a~tkanív. Príkladom takýchto proteínov sú kinesin a~myosin.
	\item \textbf{Zásobné proteíny:} slúžia na skladovanie malých molekúl a~iontov. Kasein v~mlieku poskytuje zdroj aminokyselín pre novonarodené živočíchy. 
	\item \textbf{Signálne proteíny:} ich funkciou je prenos informačných signálov medzi bunkami. Do tejto skupiny patrí známy proteín inzulín regulujúci hladinu cukru v~krvi.
	\item a~ďaľšie.
\end{itemize}

\section{Aminokyseliny}
Aminokyseliny sú odvodené od organických kyselín a~predstavujú rôzne triedy molekúl s~jednou spoločnou vlastnosťou; všetky vlastnia karboxylovú (COOH) a~aminovú ($NH_{2}$) skupinu. Tieto skupiny sú naviazané k~jednému uhlíkovému atómu, ktorý je označovaný ako $\alpha$ uhlík. Rôznorodosť jednotlivých aminokyselín spočíva v~postrannom reťazci (R) určujúcom chemické vlastnosti aminokyselín, resp. proteínov. Jednotlivé aminokyseliny sú v~proteínovej molekule vzájomne spojené peptidovou väzbou, ktorá prepojuje karboxylovú skupinu jednej aminokyseliny s~amino skupinou druhej. Reťazec viacerých aminokyselín je označovaný ako peptidový reťazec (polypeptid). 
Celkovo existuje 20 rôznych aminokyselín, ktoré môžeme na základe chemických vlastností postranných reťazcov rozdeliť na šesť základných skupín \cite{aminokyseliny}:

\begin{itemize}
	\item \textbf{Aminokyseliny s~alifatickým postranným reťazcom:} alanin (Ala), valin (Val), leucin (Leu), isoleucin (Ile), glycin (Gly)
	\item \textbf{Bazické skupiny s~aminovou skupinou na postrannom reťazci:} arginin (Arg), lysin (Lys)
	\item \textbf{S aromatickým jadrom alebo hydroxylovou skupinou na postrannom reťazci:}
	histidin (His), fenylalanin (Phe), serin (Ser), threonin (Thr), tyrosin (Tyr), tryptofan (Trp)
	\item \textbf{Kyslé skupiny s~karboxylovou alebo aminovou skupinou na postrannom reťazci:} kyselina asparagová (Asp), asparagin (Asn), kyselina glutamová (Glu), glutamin (Gln)
	\item \textbf{So sírou v~postrannom reťazci:} methionin (Met), cystein (Cys)
	\item \textbf{Obsahujúce sekundárny amin:} prolin (Pro)
\end{itemize}

\section{Syntéza proteínov}

Proteíny vznikajú z DNA v~procese nazývanom proteosyntéza. Tento proces sa skladá z~2 hlavných častí, ktorými sú transkripcia a~translácia.

\begin{itemize}

\item \textbf{Transkripcia:} pri procese transkripcie dochádza k~prepisu časti nukleotidovej sekvencie DNA (génu) do molekuly RNA. Dôležitú úlohu zohráva enzým RNA-polymeráza, ktorá musí pred začiatkom traskripcie nájsť oblasť tzv. promotoru obsahujúcu informáciu o~začiatku transkripcie a~následne sa na túto oblasť naviazať. Proces prepisu končí, keď RNA-polymeráza narazí na sekvenciu tzv. terminátoru. Výsledná molekula RNA sa označuje ako mediátorová RNA (mRNA). 
\item \textbf{Translácia:} pri procese translácie dochádza k~prenosu informácie z~mRNA do polypeptidového reťazca aminokyselín. Sekvencia nukleotidov RNA sa postupne číta po trojiciach (tzv. kodónoch), pričom každý kodón je preložený na jednu z~dvadsiatich aminokyselín. Trojica nukleotidov umožňuje vytvoriť 64 možných kombinácií, takže jedna aminokyselina môže byť reprezentovaná viacerými kodónmi. Výsledkom translácie je proteín.

\end{itemize}
\newpage
\section{Štruktúra proteínov}
Popis trojrozmernej štruktúry proteínov môžeme podľa \cite{aminokyseliny} rozdeliť do štyroch úrovní organizácie:

\begin{itemize}
	\item \textbf{Primárna štruktúra:} sekvencia aminokyselín v~polypeptidovom reťazci
	\item \textbf{Sekundárna štruktúra:} zachytáva elementy, ktoré na krátkych úsekoch v~sekvencií proteínu zaujímajú podobnú konformáciu. Ide najmä o~$\alpha$\--špirálu ($\alpha$\--helix) a~$\beta$\--~štruktúra alebo $\beta$\--skladaný list. $\alpha$\--špirála je také priestorové usporiadanie, kedy reťazec vytvára špirálu. Táto konformácia je stabilizovaná vodíkovými mostíkmi medzi peptidovými väzbami ležiacimi nad sebou \cite{aminokyseliny}. V~prípade $\beta$\--štruktúry prebiehajú úseky reťazca paralelne vedľa seba a~sú stabilizované vodíkovými mostíkmi medzi susediacimi úsekmi.
	\item \textbf{Terciálna štruktúra:} reprezentuje trojrozmerné priestorové usporiadanie zloženého polypeptidového reťazca \cite{aminokyseliny}. Na podobe výslednej terciálnej štruktúry majú vplyv chemické vlastnosti aminokyselín a~ich usporiadanie v~reťazci. 
	\item \textbf{Kvartérna štruktúra:} popisuje usporiadanie jednotlivých polypeptidových reťazcov v~molekule proteínu. Týka sa to však iba tzv. oligomerných proteínov, ktoré sú tvorené z~viac ako jedného polypetidového reťazca.
	
	Primárnu, sekundárnu, terciálnu a~kvartérnu štruktúru je možné vidieť na obrázku \ref{struktura}:
\end{itemize}
\begin{figure}[H]
		\begin{center}
		\scalebox{0.5}
		{   
			\includegraphics{structure.png}
		}
		\caption{Primárna, sekundárna, terciálna a~kvartérna štruktúra. Prevzaté a~upravené z~\cite{gromiha}.}
		\label{struktura}
	\end{center}
\end{figure}

\chapter{Vplyv aminokyselinových substitúcií na stabilitu proteínu}

Stabilita je jednou z~najdôležitejších vlastností proteínu. Motivácia skúmania stability je dnes veľká, pretože táto vlastnosť proteínov je dôležitá v~mnohých oblastich ako je medicína, kde je snahou dosiahnuť výrobu účinnejších liečiv, v~oblasti priemyslu a~poľnohospodárstva. Stabilný proteín dokáže lepšie znášať nepriaznivé podmienky okolitého prostredia, akými sú vyššie teploty alebo chemické vlastnosti okolia v~ktorom sa proteín nachádza. Na stabilitu proteínu však vplývajú aminokyselinové substitúcie, ktoré môžu proteín stabilizovať, ale aj destabilizovať. Preto vzniká potreba skúmať vplyv substitúcií na stabilitu. V~tejto kapitole sa zmienim o~stabilite proteínu, čo stabilitu určuje a o~dôvodoch vzniku a~vplyve mutácií.


\section{Stabilita proteínu}
Stabilita proteínu je určená množinou vzájomne pôsobiacich a~ovplyvňujúcich sa síl. Tieto sily určujú, či sa proteín nachádza vo svojom pôvodnom zloženom alebo rozloženom (denaturovanom) stave. Stabilita je úzko prepojená so stavom, v~ktorom sa proteín nachádza. Stabilný proteín sa nachádza v~zloženom stave, ktorý je stabilizovaný rôznymi vzájomnými interakciami, kde patria hydrofóbne, elektrostatické, vodíkové väzby alebo aj van der Waalsove sily. Naopak, nestabilný proteín sa nachádza v~denaturovanom stave, kde dominuje entropická a~neentropická voľná energia \cite{gromiha}.

Stabilitu proteínu je možné reprezentovať ako zmenu tzv. Gibbsovej (voľnej) energie ($\Delta$G) potrebnej na prechod proteínu zo zloženého do denaturovaného stavu, alebo naopak. 
Gibbsova voľná energia je termodynamický potenciál vyjadrujúci maximálne množstvo reverzibilnej práce, ktorá môže byť uskutočnená termodynamickým systémom pri konštantnej teplote a~tlaku. Gibbsova voľná energia je definovaná nasledujúcim vzťahom \cite{gibbs}:
\begin{align}
	G = H - TS,
\end{align}
kde $H$ predstavuje entalpiu, $T$ teplotu a~$S$ entropiu.

Zmena voľnej Gibbsovej energie ($\Delta G$) je daná vzťahom
\begin{align}
	\Delta G = G_{folded} - G_{unfoldeded},
\end{align}
kde $G_{folded}$ predstavuje voľnú energiu v~zloženom a~$G_{unfolded}$ energiu v~nezloženom stave.
Existuje niekoľko laboratórnych metód na určenie stability ako napríklad cirkulárny dichroizmus (CD), diferenciálna skenovacia kalorimetria (DSC), fluorescencia (Fl), absorpcia svetla (Abs), nukleárna magnetická rezonancia (NMR) \cite{gromiha}.

Určenie stability bez použitia niektorej z~laboratórnych metód je možné uskutočniť výpočtom jedného z~existujúcich silových polí (Talaris, Score12, ...). Výpočet takéhoto poľa ukazuje nasledujúci jednoduchý príklad \cite{free_energy} \cite{gromiha}:

Voľná energia v~zloženom stave je daná vzťahom  
	\begin{align}
		G_{F} = G_{hy} + G_{el} + G_{hb} + G_{vw} + G_{ss},
	\end{align}

kde $G_{hy}, G_{el}, G_{hb}, G_{ss}, G_{vw}$ sú hydrofóbne, elektrostatické, vodíkové, disulfidické a~van der Waalsove voľné energie. 


Elektrostatickými interakciami najviac prispievajú nabité postranné reťazce reziduí Lysine, Hystodine, Arginine, kyselina asparagová a~glutamová.

Vodíkové väzby sú jednými z~hlavných zúčastnených pri tvorbe sekundárnej štruktúry proteínu. Výpočet ich príspevku je založený najmä na ich geometrických informáciách.

Voľná energia v~nezloženom stave je daná vzťahom
\begin{align}
	G_U = G_{en} + G_{ne},
\end{align}
kde $G_{en}$ a~$G_{ne}$ sú entropické a~neentropické voľné energie.


\section{Mutácie}
Mutácie sú náhodné alebo cielené zmeny v~DNA. Sú naprosto nevyhnutné pre biologickú evolúciu, bez nich by sa skôr či neskôr zastavila. Ak by sa výraznejšie zmenili podmienky vonkajšieho prostredia, organizmy by bez mutácií nemuseli na zmeny zareagovať a~pravdepodobne by vyhynuli. Za mutácie sú považované všetky také zmeny týkajúce sa genetickej informácie, ktoré nie sú výsledkom segregácií a~rekombinácií už existujúcich častí genotypov \cite{mutace}. 
Podľa úrovne, na ktorej sa mutácia vyskytla, môžeme rozlišovať \cite{flegr}:
\begin{itemize}
	\item \textbf{Génové mutácie:} zmena v~stavbe DNA, ktorá je reprezentovaná zmenou nukleotidovej sekvencie na určitom mieste. Nazývajú sa tiež bodovými mutáciami a z~hľadiska predikcie sú najzásadnejšie.
	\item \textbf{Chromozómové mutácie:} mení sa štruktúra chromozómu.
	\item \textbf{Genómové mutácie:} mení sa počet chromozómov.
\end{itemize}

\subsection{Vznik mutácií}

Mutácie nevznikajú náhodne, každá mutácia má svoju príčinu za ktoru stojí pôsobenie tzv. mutagénnych faktorov. Medzi najdôležitejšie patria chemické a~fyzikálne faktory.

Medzi fyzikálne faktory patria rôzne zdroje žiarenia, najmä ionizujúce a~ultrafialové. Poškodenie štruktúry DNA je priamo úmerné množstvu absorbovaného žiarenia.

Medzi chemické faktory môžeme zaradiť genotoxické látky, tzv. genotoxíny. Takýchto látok je veľké množstvo a~patria medzi ne napríklad pesticídy, herbicídy, niektoré farbivá, konzervačné a~dezinfekčné látky \cite{mutace}. 

\subsection{Typy mutácií}

Podľa \cite{flegr} sa rozlišujú tri základné typy génových mutácií:
\begin{itemize}
	\item \textbf{Substitúcia:} jedná sa o~zámenu jedného alebo viacerých nukleotidov. V~tomto prípade sa nemení dĺžka pôvodného proteínu. Novovziknutý proteín sa oproti pôvodnému obvykle líši v~jednej aminokyseline.
	\item \textbf{Vloženie:} jedná sa o~vloženie jedného alebo viacerých nukleotidov do pôvodnej sekvencie, spôsobuje zväčšenie dĺžky sekvencie.
	\item \textbf{Odstránenie:} odstránenie jedného alebo viacerých po sebe nasledujúcich nukleotidov, mení dĺžku sekvencie rovnako ako vloženie.
\end{itemize}

\begin{figure}[H]
	\centering
	\begin{center}
		\scalebox{0.6}
		{   
			\includegraphics{mutation_types.png}
			%https://www.bbc.co.uk/education/guides/zc499j6/revision/2
		}
		\caption[mutacie]{Jednotlivé typy mutácií\footnotemark.}
	\end{center}
\end{figure}
\footnotetext{Zdroj: \url{https://www.bbc.co.uk/education/guides/zc499j6/revision/2}}

V~prípade, že k~mutácií dôjde v~kódujúcej oblasti, mutácie je možné rozlíšiť na \cite{flegr}:
\begin{itemize}
	\item \textbf{Synonymné:} vychádzajú z~tzv. degenerovanosti genetického kódu. Zámena nukleotidu v~kodóne sa tak na štruktúre proteínu nemusí vôbec prejaviť a~vyzerá to tak, ako keby k~mutácií vôbec nedošlo. 
	\item \textbf{Nesynonymné:} pri zmene nukleotidu v~kodóne dochádza k~zmene aminokyseliny a~rovnako aj k~zmene konformácie proteínu.
	\item \textbf{Posunové:} spôsobujú zmenu čítacieho rámca a~často vedú k~predčasnému ukončeniu prekladu proteínu.
	\item \textbf{Nezmyselné:} vytvárajú STOP kodón a~tým spôsobujú predčasné ukončenie prekladu proteínu.
\end{itemize}
\newpage
Na stabilitu proteínu vplývajú aminokyselinové mutácie, ktoré môžu spôsobiť to, že proteín sa stane nestabilným. Preto do hlavnej oblasti skúmania stability patrí predikcia zmeny stability na základe aminokyselinovej mutácie. Jedná sa o~predikciu zmeny Gibbsovej voľnej energie ($\Delta\Delta$G) medzi voľnou energiou pôvodného a~zmutovaného proteínu. Môžeme ju definovať nasledujúcim vzťahom:
\begin{align}
	\Delta\Delta G = G_{mutant} - G_{wild\_type},
\end{align}
Podľa tejto hodnoty je možné rozdeliť mutácie na stabilizujúce, neutrálne a~destabilizujúce. Väčšia snaha pri predikcií môže viesť k~zlepšeniu návrhu nových odolnejších proteínov alebo pri štúdií rozličných chorôb.


\chapter{Strojové učenie}
\label{ml}
Strojové učenie je v~súčasnej dobe chápané ako disciplína umelej inteligencie. Základnou technikou strojového učenia je prehľadávanie stavového priestoru. K~charakteristickým vlastnostiam patrí využívanie znalostí, práca so symbolickými či štruktúrovanými premennými \cite{machine_learning}. Pojem strojové učenie takisto označuje počítačové metódy pracujúce s~obrovským množstvom dát, v~ktorých sa hľadajú rôzne vzory a~pravidelnosti. Takéto metódy nachádzajú svoje uplatnenie pri hľadaní riešení v~mnohých odvetviach akými sú počítačové videnie, rozpoznávanie reči a~takisto bioinformatika. Keďže strojové učenie nachádza v~mnohých odvetviach čoraz väčšie uplatnenie, je potrebné brať do úvahy jeho výhody a~rovnako aj nevýhody. Medzi výhody patrí automatické hľadanie spojitostí vo veľkom množstve dát. Medzi hlavné nevýhody metód patrí neschopnosť správnej analýzy dát pri nevyváženosti predložených dát, nesprávne výsledky pri malom množstve trénovacích dát pre metódu, alebo príliš veľký počet parametrov vstupných dát.

V~tejto kapitole sa budem venovať základným technikám strojového učenia a~popisom používaných algoritmov. 

\section{Úvod do strojového učenia}

Podľa \cite{alpaydin} je možné algoritmy strojového učenia rozdeliť do 3 základných skupín:
\begin{itemize}
	\item \textbf{Klasifikácia:} Rieši problém priradenia výstupnej triedy vstupným dátam, ktoré môžu byť reprezentované vektorom hodnôt. Ako príklad si je možné predstaviť zatriedenie žiadateľov o~pôžičku do tried s~vysokým alebo nízkym rizikom toho, že pôžičku nebudú schopní splácať na základe rôznych údajov o~žiadateľoch.
	\item \textbf{Regresia:} Regresné metódy na rozdiel od klasifikačných nepriraďujú vstupom výstupnú triedu, ale snažia sa určiť priamo číselnú hodnotu výstupu. Príkladom môže byť určenie ceny ojazdeného auta na základe parametrov ako počet najazdených kilometrov, značka, rok výroby.
	\item \textbf{Hľadanie asociácií:} Asociačné pravidlá slúžia na hľadanie zaujímavých asociácií vo veľkom objeme dát. Pri ich hľadaní nás zaujíma podmienená pravdepodobnosť, ktorá sa uvádza vo forme $P(X|Y)$, $Y$ je produkt podmienený výskytom produktu $X$. 
\end{itemize}

\newpage
Metódy strojového učenie môžeme ďalej rozdeliť na základe spôsobu, akým sa učia. Podľa \cite{alpaydin} sa rozdeľujú na:
\begin{itemize}
	\item \textbf{Učenie s~učiteľom:} Pri tomto type učenia je nutné mať k~dispozícií vstupné aj výstupné dáta. Cieľom je nájsť vzťahy medzi vstupom a výstupom, ktoré slúžia na naučenie metódy. Medzi algoritmy patriace do tejto skupiny sa radí regresia aj klasifikácia.
	\item \textbf{Učenie bez učiteľa:} V~tomto type učenia nie sú k~dispozícií referenčné výstupné dáta, ale len vstupné. Snahou je nachádzať pravidelnosti vo vstupných dátach. Medzi takéto metódy patria rôzne typy zhlukovania. 
\end{itemize}

\section {Rozhodovacie stromy}
Rozhodovací strom je hierarchický model so stromovou štruktúrou. Metódy tohto typu používajú učenie s~učiteľom a~môžeme ich použiť na klasifikáciu aj regresiu. Štruktúra stromu je tvorená z~dvoch typov uzlov, vnútorných (nelistových) a~listových uzlov. Každý z~nelistových uzlov obsahuje testovaciu funkciu. Po vyhodnotení tejto funkcie sa vyberie nasledujúci uzol, v~ktorom sa bude pokračovať. Tento proces začína v~koreňovom uzle a~pokračuje rekurzívne až do dosiahnutia listového uzlu. Listový uzol obsahuje označenie triedy, do ktorej bude zaradený vstupný vektor, alebo číselnú hodnotu.

\subsection{Algoritmus J48}

Algoritmus J48 patrí k~metódam rozhodovacích stromov. Jedná sa o modifikovanú implementáciu algoritmu C4.5 v~nástroji WEKA. Algoritmus produkuje klasifikačno-~rozhodovací strom pre poskytnuté dáta rekurzívnym rozdeľovaním dát. Pri rozhodovaní je využitá stratégia depth-first. Algoritmus berie do úvahy všetky možné testy, ktoré môžu rozdeliť dáta, a~vyberá test udávajúci najlepšiu informačnú hodnotu. Pre každý diskrétny atribút je zvážený jeden test s~počtom výsledkov, ktorý zodpovedá počtu rôznych hodnôt atribútov.  

\subsection{Algoritmus Náhodný strom (Random Tree)}

Pri tomto algoritme je strom náhodným stromom vytvoreným náhodne z~množstva všetkých možných stromov. Každý list obsahuje $k$ náhodných parametrov. Náhodné vytvorenie stromu v~tomto kontexte znamená, že každý strom v~množine stromov má rovnakú šancu výberu. Kombinácia veľkého počtu náhodných stromov obvykle vedie k~správnemu modelu. 

\subsection{Algoritmus Náhodný les (Random Forest)}

Random Forest \cite{breiman} je metóda založená na kombinácií viacerých rozhodovacích stromov. Každý strom závisí na hodnotách náhodného vektora hodnôt navzorkovaného nezávisle a s~rovnakým rozložením pre všetky stromy v~tzv. lese stromov. Obecne môžeme metódu popísať nasledujúcou definíciou:

Náhodný les (random forest) je klasifikátor tvorený kolekciou klasifikátorov so stromovou štruktúrou $\{h(x,\Theta_{k}), k=1, ...\}, $ kde $\{k\}$ sú nezávisle identicky rozdelené náhodné vektory a~každý strom hlasuje jednotlivo o~najpopulárnejšej triede vo vstupe $x$.
\newpage
Najväčšiu pozornosť tejto metódy tvoria 3 vlastnosti:
\begin{itemize}
	\item poskytuje presnú predikciu pre mnohé typy aplikácií
	\item je schopná merať dôležitosť jednotlivých parametrov pri trénovaní modelu
	\item blízkosť medzi vzorkami môže byť meraná trénovaným modelom
\end{itemize} 

Algoritmus náhodný les pre klasifikáciu aj regresiu je možné zjednodušene popísať nasledovne, pričom je uvažovaných $M$ rozhodovacích stromov. Schéma metódy je znázornená na obrázku \ref{random_forest}:
\begin{itemize}
	\item Pre každý z~$M$ rozhodovacích stromov sa vytvorí sada trénovacích dát z~originálnych dát. Na ich výber slúži metóda tzv. bagging, ktorá náhodne vyberie zadaný počet trénovacích dát.
	\item Pre každú množinu trénovacích dát je vytvorený klasifikačný alebo regresný strom, ktorý je následne natrénovaný na $M$-tej náhodnej množine trénovacích dát. V~tejto metóde je každý uzol rozdelený najlepším rozdelením spomedzi podmnožiny prediktorov náhodne vybraných v~tomto uzle. Naopak, pri klasických stromoch je uzol rozdelený na základe najlepšieho rozdelenia medzi všetkými premennými.
	\item Predikcia nových dát spojením výsledkov predikcie M stromov, napríklad hlasovaním väčšiny (tzv. majority voting) pri klasifikácií alebo priemerom hodnôt pri regresií.
\end{itemize}

Rozšírenie algoritmu náhodný les je momentálne veľmi aktívnou oblasťou vo výpočetnej biológií. Metóda nachádza veľké uplatnenie v~bioinformatike, napríklad aj pri nástrojoch predikujúcich stabilitu proteínov.

\begin{figure}[H]
	\centering
	\begin{center}
		\scalebox{0.8}
		{   
			\includegraphics{rf.png}
			
		}
		\caption[Random Forest]{Metóda Random Forest\footnotemark.}
		\label{random_forest}
	\end{center}
\end{figure}
\footnotetext{Prevzaté a~upravené z~\url{http://bit.ly/2rpjSDK}}

\section {Support vector machines (SVM)}

Support vector machines patria k~najnovším metódam strojového učenia. Prvýkrát boli publikované v prácach \cite{svm} \cite{svm2}. Tieto metódy uskutočňujú klasifikáciu konštruovaním N-dimenzionálnej nadroviny, ktorá optimálne rozdeľuje dáta do dvoch kategórií. Cieľom je nájsť takú nadrovinu, ktorá rozdelí vstupné vektory tak, že jedna skupina vektorov je na jednej strane roviny a~druhá na strane opačnej. Vektory nachádzajúce sa blízko nadroviny sú označované ako tzv. podporné vektory (support vectors). 

Ak sú trénovacie dáta lineárne rozdeliteľné, potom pár $(\textbf{w},b)$ existuje ako 

	$\textbf{w}^{T}\textbf{x}_{i} + b \geq 1$, pre všetky $\textbf{x}_{i} \in P$
	
    $\textbf{w}^{T}\textbf{x}_{i} + b \leq -1$, pre všetky $\textbf{x}_{i} \in N$
    
s~rozhodovacím pravidlom daným vzťahom $f_{\textbf{w},b} ( x ) = sgn(\textbf{w}^{T}x + b )$, kde $\textbf{w}$ je váhový vektor a~$b$ je odchýlka (tzv. bias).

V~prípade, že dáta sú lineárne rozdeliteľné do dvoch tried, optimálnu nadrovinu je možné nájsť minimalizovaním štvorcovej normy rozdeľujúcej nadroviny. Jedná sa o~konvexný kvadratický programovací problém.
Pri možnosti lineárneho rozdelenia sa snaží SVM nájsť 1-dimenzionálnu nadrovinu (priamku), ktorou rozdelí skupiny vstupných vektorov. Po rozdelení dát priamkou metóda zistí vzdialenosť priamky od najbližších podporných vektorov. Táto vzdialenosť sa označuje ako tzv. krajná hranica (margin), pričom sa hľadá najväčšia vzdialenosť medzi podpornými vektormi.  

Lineárne rozdeliteľné dáta sú však len ideálnym príkladom. Ak by analýza pozostávala len z~premenných z~dvoch kategórií, dvoch predikovaných premenných a~množiny bodov rozdeliteľných priamkou, bolo by to veľmi jednoduché. V~skutočnosti sa tieto metódy musia vysporiadať s~viac ako dvomi predikovanými premennými, rozdelením dát nelineárnymi krivkami alebo množinami dát, ktoré nie je možné úplne rozdeliť. 

\subsection{Jadrové funkcie}

Pri väčšine reálnych problémov neexistuje lineárna nadrovina rozdeľujúca pozitívne a~negatívne vzorky v~trénovacích dátach. Jedným z~riešení je prenesenie dát do priestoru, ktorý má viac dimenzí a~definovať rozdeľujúcu nadrovinu v~tomto priestore. Takýto viacdimenzionálny priestor sa nazýva priestor transformovaných vlastností. S~vhodne vybraným priestorom transformovaných vlastností dostatočnej dimenzie je možné rozdeliť ľubovoľnú trénovaciu dátovú sadu.
Mapovanie dát do iného (potencionálne nekonečného) Hilbertovho priestoru H je definované ako $\Phi:R^{d} \rightarrow H$. Trénovací algoritmus bude potom závisieť len na dátach cez bodové produkty v~H, napríklad na funkciách v~tvare $\Phi(x_{i})\cdot\Phi(x_{j})$. Ak by existovala tzv. jadrová funkcia K taká, že $K(x_{i},x_{j}) = \Phi(x_{i})\cdot\Phi(x_{j})$, v~algoritme by sme potrebovali iba K. 

Jadrové funkcie sú špeciálnou triedou funkcií umožňujúce výpočet vnútorných produktov priamo v~priestore vlastností bez nutnosti mapovania dát tak, ako to bolo popísané vyššie. 
Akonáhle je vytvorená nadrovina, jadrová funkcia je použitá na mapovanie nových bodov do priestoru vlastností pre klasifikáciu.
\newpage
Výber vhodnej aproximačnej jadrovej funkcie je dôležitý, pretože funkcia definuje transformovaný priestor vlastností v~ktorom budú klasifikované trénovacie dáta. Medzi najpoužívanejšie patria tieto jadrové funkcie \cite{alpaydin}: 
\begin{itemize}
	\item Polynomiálna funkcia stupňa $P$, ktorý je zvolený užívateľom
	\begin{align}
		 K(x,y) = (x \cdot y + 1)^{P}
	\end{align} 
	\item Radiálne-bázová funkcia (RBF) 
	\begin{align}
		K(x,y) = e^{- {\parallel x - y \parallel}^{2}/ {2\sigma}^{2}}
	\end{align}
	\item Sigmoidná funkcia
	\begin{align}
		K(x,y) = tanh (\kappa x \cdot y -\delta)^{P}
	\end{align}
\end{itemize}


\subsection{Algoritmus SMO}

Sekvenčná minimalizačná optimalizácia (SMO) \cite{smo} je algoritmus na trénovanie SVM, ktorý jednoducho rieši kvadratický SVM problém. SMO uskutočňuje dekompozíciu celkového problému na podproblémy riešené analyticky. Metóda si v~každom kroku vyberá na vyriešenie najmenší optimalizačný problém. Pre typický kvadratický SVM problém, najmenší možný optimalizačný problém zahŕňa dva Lagraengove násobitele. V~každom kroku si metóda vyberia dva tieto násobitele na spoločnú optimalizáciu, nájde pre ne optimálne hodnoty a~aktualizuje SVM. Výhodou tohto algoritmu je, že množstvo potrebnej pamäte pri trénovacej sade je lineárne, čo umožňuje algoritmu pracovať s~veľkými trénovacími sadami. 
 
\section{Algoritmus Naive Bayes}

Naive Bayes je klasifikačným algoritmom pre klasifikačné problémy, kde sa vyskytujú dve alebo viac tried. Je založený na Bayesovom teoréme s~nezávislými predpokladmi medzi prediktormi. Klasifikátor predpokladá, že efekt hodnoty $x$ prediktoru na danú triedu $c$ je nezávislý na hodnotách ďaľších prediktorov. Predpoklad sa nazýva triedna podmienená nezávislosť. 

Tento model je jednoduchý na vytvorenie, no napriek svojej jednoduchosti klasifikátor často poskytuje dobré výsledky a~je široko používaný, pretože v~mnohých prípadoch prekonáva komplikovanejšie klasifikačné metódy.

\chapter{Ensemble metódy}

V~posledných rokoch sa metódy strojového učenia využívajú vo veľkej miere v~oblasti bioinformatiky. Napriek ich výhodám vznikajú rôzne problémy spojené najmä s~nedostatkom dát, veľkou rôznorodosťou dát, alebo tzv. preučením metód. Jedným z~riešení, ktoré vykazujú dobré výsledky, je využitie výstupov z~viacerých klasifikátorov namiesto použitia jedného samostatného klasifikátora. Takáto kombinácia môže niekedy poskytnúť protichodné výsledky a~tým pomôže zvýšiť presnosť a~robustnosť predikcie. Prístup využitia viacerých klasifikátorov je označovaný ako tzv. ensemble stratégia.

Podľa \cite{polikar} existuje mnoho teoretických a~praktických dôvodov na použitie ensemble systémov:
\begin{itemize}
	\item \textbf{Štatistické dôvody:} Dobrý výkon metódy na trénovacích dátach nemusí predpovedať dobrú výkonnosť zovšeobecňovania. Množina klasifikátorov s~podobným výkonom na trénovacích dátach môže mať rôznu zovšeobecňovaciu výkonnosť. Tento poznatok je možné vidieť najmä, ak testovacie dáta určené na rozlíšenie schopnosti zovšeobecňovať nie sú dostatočne reprezentatívne. V~takýchto prípadoch môže spriemerovanie výstupov niekoľkých klasifikátorov znížiť riziko zlého výberu alebo slabého klasifikátoru. 
	\item \textbf{Veľký objem dát:} V~určitých oblastiach môže nastať problém príliš veľkého objemu dát, ktorý má byť spracovaný. To nie je niekedy možné efektívne uskutočniť len pomocou jedného klasifikátora. V~takýchto situáciách je vhodné zvážiť rozdelenie dát na menšie celky, trénovať klasifikátory na menších celkoch a~skombinovať ich výstupy pomocou vhodného kombinačného pravidla.
	\item \textbf{Malý objem dát:} Dostupnosť dostatočného a~reprezentatívneho mmnožstva trénovacích dát je dôležitá pre klasifikačný algoritmus, aby bol schopný dosiahnuť úspešného naučenia rozdelenia dát. Pri nedostatku trénovacích dát sa osvedčili techniky prevzorkovania, ktoré sú vhodné na vytvorenie náhodných prekrývajúcich sa podmnožín dostupných dát a~každú je možné použiť na učenie iného klasifikátora.
	\item \textbf{Rozdeľuj a panuj:} Napriek dostatku dát sú niektoré problémy pre klasifikátory príliš zložité, napríklad rozhodovacia hranica rozdeľujúca dáta môže byť veľmi komplexná, alebo leží mimo oblasti funkcií dostupných pre vybraný klasifikačný model. Ako príklad je možné uviesť dáta, ktoré nie je možné lineárne rozdeliť. Žiadny lineárny klasifikátor nie je schopný dáta rozdeliť, avšak vhodná kombinácia lineárnych klasifikátorov tzv. ensemble systému by bola schopná naučiť sa túto nelineárnu hranicu. Dáta sú v~tomto prípade rozdelené na menšie celky, pričom každý klasifikátor sa učí jednu z~častí.
\end{itemize}

\section{Rôznorodosť v ensemble systémoch}

V~posledných rokoch niekoľko štúdií teoreticky \cite{teoret1} aj empiricky \cite{empiric1} ukázalo, že použitie ensemble systému viacerých klasifikátorov prekonáva výsledky samostatného klasifikátora, keď členovia systému sú dostatočne presní a~robia niekoľko zhodných chýb. 
Pretože je takmer nemožné natrénovať klasifikátor, ktorý by dokonale zvládol rozdeliť stavový priestor bez výskytu chyby, sú potrebné klasifikátory, ktoré robia chyby na odlišných častiach trénovacích dát. Ak sú splnené tieto podmienky, je možné dosiahnuť robustnejšej a~presnejšej predikcie. 

Ako príklad tohto faktu je možné uviesť demonštráciu uvedenú v~jednej zo Zhangových štúdií \cite{zhang}. V~nej je demonštrované, že ensemble systém pozostávajúci z~troch rovnakých klasifikátorov s~presnosťou 95\% je horší ako ensemble pozostávajúci z~klasifikátorov, ktorých presnosť je len 67\% a~najmenšou chybou medzi dvojicou klasifikátorov. Na základe týchto poznatkov je možné usúdiť, že rôznorodosť medzi členmi ensemble systému je rozhodujúca pri zlepšovaní predikcie.

Existuje niekoľko možností ako dosiahnuť vysokú rôznorodosť jednotlivcov:
\begin{itemize}
	\item \textbf{Rôzne trénovacie dátové sady:} Trénovacia dátová sada môže byť rozdelená na menšie celky a~každá takáto menšia podsada je použitá na natrénovanie jedného samostatného klasifikátora. Na rozdelenie dát môže byť použitá technika z~niekoľkých dostupných prevzorkovávacích techník. Jednou z~najbežnejších takýchto techník je tzv. bootstrap technika. Exituje však niekoľko ďaľších, napríklad metódy ako tzv. jack-knife.
	\item \textbf{Rôzne trénovacie parametre:} Použitie rôznych trénovacích parametrov pre jednotlivé klasikikátory je tiež jednou z~možných ciest. Napríklad viacvrstvová neurónová sieť môže byť trénovaná využitím rôznych vstupných váh vrstiev a~uzlov v~každej vrstve. Tento prístup umožňuje kontrolu nestability klasifikátorov a~ako následok prispieva k~ich rozmanitosti. 	
	\item \textbf{Rôzne parametre pri predikcií:} Lineárny klasifikátor môže mať niekedy problém s~nachádzaním vzorov u parametrov, ktoré sú veľmi vzdialené. Pre riešenie tohto problému môže byť prospešné experimentovanie s~rôznymi podsadami predikovaných parametrov generovaných buď metódami učenia s~učiteľom alebo bez neho \cite{dataclas}.	
	\item \textbf{Rôzne typy klasikikátorov:} Neexistuje žiadny nadradený klasifikátor, ktorý by poskytoval najlepšie výsledky bez ohľadu na oblasť odborníka alebo množstva trénovacích dát. Na druheje strane, na každý problém zvyčajne existuje niekoľko vhodných klasifikátorov, preto výber niekoľkých z~nich a~kombinácia ich výstupov je možnou cestou ako vytvoriť množinu klasifikátorou s~rôznymi rozhodovacími hranicami.
\end{itemize}

\newpage
\section{Tvorba ensemble systémov}

Existujú dva základné spôsoby, ako vybrať členov ensemble systému: bagging a~boosting. Príklad ensemble systému je možné vidieť na obrázku \ref{ensemble}.

\subsection{Bagging}

Bagging \cite{breiman2} alebo aj tzv. bootstrap aggregation je jednou z~najstarších, ľahko implementovateľných ensemble stratégií. Bola navrhnutá na zlepšenie presnosti algoritmov strojového učenia používaných pri štatistickej klasifikácií a~regresií. Rôznorodosť je dosiahnutá využitím tzv. bootstrap podmnožín trénovacích dát, pričom rôzne trénovacie množiny sú vybrané náhodne s~náhradou z~celého množstva trénovacích dát. Každá takáto podmnožina je určená na trénovanie iného klasifikátora rovnakého typu. Nakoniec sa využije hlasovanie väčšiny na výsledkoch jednotlivých klasifikátorov. Trieda vybraná najväčším počtom klasifikátorov sa stáva konečným rozhodnutím ensemble systému.

Bagging je výkonným mechanizmom najmä pri obmedzenom množstve spoľahlivých dát. Na zaistenie dostatočného množstva trénovacích vzorkov v~podmnožinách je približne 75 až 100\% vzorkov prítomných v~každej podmnožine. Nastáva tak veľký prekryv medzi trénovacími podmnožinami a~mnoho vzorkov sa nachádza viackrát v~danej podmnožine. V~takomto prípade sa rôznorodosť zaistí použitím nestabilného klasifikačného modelu pre ktorý je možné získať rôzne rozhodovacie hranice s~rôznymi trénovacími dátami. Techniky ako neurónové siete alebo rozhodovacie stromy sú dobrými príkladmi na tento účel, pretože ich nestabilnosť je kontrolovateľná výberom ich parametrov.

\subsection{Boosting}

Boosting \cite{boosting} je ďaľším algoritmom na výber členov ensemble systému. Bolo dokázané, že slabý klasifikátor (iba o niečo úspešnejší ako náhodné hádanie) je možné pretvoriť na silný klasifikátor, ktorý poskytuje správne predikcie pre všetky prípady z~ľubovoľne malej časti prípadov. Rovnako ako bagging, boosting vytvára súbor klasifikátorov prevzorkovaním dát s~použitím hlasovania väčšiny. Prevzorkovanie je pri boostingu zlepšené, aby každému klasifikátoru boli poskytnuté najviac informatívne trénovacie dáta. Boosting vytvára tri slabé klasifikátory:
\begin{itemize}
	\item Prvý klasifikátor $C_{1}$ je trénovaný na náhodnej podmnožine dostupných dát.
	\item Trénovacia podsada pre klasifikátor $C_{2}$ je vybraná ako najinformatívnejšia podsada vo vzťahu k $C_{1}$. Klasifikátor $C_{2}$ je teda trénovaný na dátach, na ktorých mal $C_{1}$ polovičnú úspešnosť. 
	\item Tretí klasifikátor $C_{3}$ je trénovaný na dátach, kde $C_{1}$ a $C_{2}$ nesúhlasili.
	\item Nakoniec sú klasifikátory skombinované hlasovaním väčšiny.
\end{itemize}

\begin{figure}[H]
	\centering
	\begin{center}
		\scalebox{0.4}
		{   
			\includegraphics{ensemble.png}
			%https://www.bbc.co.uk/education/guides/zc499j6/revision/2
		}
		\caption[ensemble]{Ensemble systém. Prevzaté a upravené z \cite{polikar}.}
		\label{ensemble}	
\end{center}
\end{figure}

\section{Spojenie klasifikátorov}

Po natrénovaní jednotlivých klasifikátorov je potrebné ich spojiť najvhodnejším spôsobom. Tieto metódy môžeme rozdeliť do dvoch kategórií: netrénovateľné a~trénovateľné. Netrénovateľné sú použiteľné, ak samostatný klasifikátor poskytuje porovnateľné výsledky vo väčšine častí priestoru vlastností. Trénovateľné metódy dynamicky menia rozhodovacie pravidlá podľa špecifického typu klasifikovaného prípadu, sú užitočné v~prípadoch, keď klasifikátory konštantne správne alebo nesprávne klasifikujú určité prípady.

\subsection{Trénovateľné metódy}
Medzi trénovateľné metódy patria nasledovné:
\begin{itemize}
	\item \textit{Stacked generalization:} Snahou je vytvoriť metaklasifikátor s~využitím poznatkov o~presnosti klasifikátorov. Dostupné dáta sú rozdelené na trénovaciu a~testovaciu sadu. Všetky nástroje sú trénované na trénovacej sade, testovacia sada je použitá na určenie výkonnosti klasifikátorov a~tvorbu metaklasifikátoru.
	\item \textit{Rozhodcovské stromy:} Jedná sa o~prístup zdola nahor pri tvorbe ensemble systému. V~prvom kroku sú dáta rozdelené do konečného počtu neprekrývajúcich sa podsád a~každá z~nich je určená na trénovanie toho istého typu klasifikátora. Pre každý pár je vytvorený tzv. rozhodca a~proces sa rekurzívne opakuje pokým nezostane len jeden klasifikátor na aktuálnej úrovni. 
\end{itemize}

\subsection{Netrénovateľné metódy}

Do kategórie netrénovateľných metód môžeme zaradiť nasledujúce metódy:
\begin{itemize}
	\item \textit{Hlasovanie väčšiny:} Najjednoduchšia metóda, ktorá priradí objektu triedu na základe počtu hlasov jednotlivých klasifikátorov. Existujú 3 typy: jednotné hlasovanie, kde sa všetky klasifikátory musia zhodnúť na predikcií; jednoduché hlasovanie v~ktorom sa aspoň polovica klasifikátorov musí zhodnúť na rozhodnutí; väčšinové hlasovanie, kde je výsledok daný podľa počtu hlasov.
	\item \textit{Váhované hlasovanie väčšiny:} Tento prístup je vylepšením predchádzajúceho prístupu, jednotlivé klasifikátory majú rôznu váhu v konečnom rozhodovaní a~tieto váhy by mali byť prispôsobené ich presnosti.
	\item \textit{Bayesova kombinácia:} Váhovaná metóda, váha spojená s~klasifikátorom je tzv. posterior pravdepodobnosť klasifikátora na trénovacej sade.
	\item \textit{Váhovanie entropie:} Rovnako sa jedná o~váhovanú metódu a~váhy klasifikátorov sú nepriamo úmerné entropií klasifikačného vektoru.
\end{itemize}


\chapter{Nástroje na predikciu stability}

Ako je už uvedené v kapitole \ref{ml}, strojové učenie nachádza čoraz väčšie uplatnenie v~rôznych oblastiach akou je aj bioinformatika. V~oblasti skúmania a~predikcie stability vzniká mnoho nástrojov využívajúcich práve rôznych techník a~metód strojového učenia. Takéto nástroje sú však zatiaľ len vo svojich začiatkoch a~majú mnoho nedostatkov spojených najmä s~potrebnými dátami. Ďaľšou skupinou nástrojov na predikciu stability sú také, ktoré využívajú tzv. silové polia. Túto skupinu nástrojov môžeme rozdeliť na také, ktoré využívajú fyzikálne efektívne energetické funkcie simulujúce základné sily pôsobiace medzi atómami a~na metódy založené na štatistických potenciáloch, pre ktoré sú energie odvodené z~výskytu reziduí alebo atómoých spojoch uvedených v~dátových sadách pozostávajúcich z~experimentálne charakterizovaných mutovaných proteínov.
V~tejto kapitole sa zameriam na stručné zhodnotenie a~opis rôznych predikčných nástrojov patriacich do vyššie uvedených kategórií.

\section{Strojové učenie}

Strojové učenie nachádza čoraz širšie uplatnenie v~bioinformatike a~mnohé predikčné nástroje ho využívajú ako svoj základ. V~tejto sekcií sa nachádza charakteristika nástrojov využívajúch práve metódy strojového učenia.

\subsection{AUTO-MUTE}

Nástroj využíva klasifikačné metódy na určenie vplyvu mutácie a~regresiu na určenie hodnoty $\Delta\Delta G$.
Na začiatku je identifikovaných šesť najbližších susedov aminokyseliny na mutovanej pozícií a~určia sa ich vlastnosti. Vektor vlastností, tvorený vlastnosťami založenými na energií, je určený na natrénovanie vybranej metódy zvolenej užívateľom. Nástroj využíva algoritmy z~balíka programu WEKA, konktrétne je možné zvoliť metódy Random Forest a~SVM pre klasifikáciu alebo Tree Regression a~SVM Regression pre regresiu. AUTO-MUTE je dostupný ako webový server alebo ako samostatná aplikácia \cite{automute}.

\subsection{I-Mutant}

Nástroj poskytuje predikciu znamienka zmeny stability pomocou klasifikácie a~tiež určenie hodnoty $\Delta\Delta G$ pomocou regresie. I-Mutant pracuje so štrukturálnymi alebo sekvenčnými informáciami o mutovanej aminokyseline a~jej najbližších susedoch. Pre strojové učenie je použitá metóda SVM s~jadrovou funkciou RBF (Radial Basis Function). Trénovacie dáta pozostávajú z~podmnožiny dát pochádzajúcich z~databázy ProTherm. Vstupný vektor vlastností mutácie tvorí spolu 42 hodnôt. Nástroj je dostupný ako webový server \cite{imutant}. 

\subsection{iPTREE-STAB}

iPTREE-STAB slúži na určenie vplyvu mutácie na stabilitu a~hodnoty $\Delta\Delta G$ z~informácií o~sekvencií. Predikcia je založená najmä na využítí rozhodovacích stromov spojených s~algoritmom adaptive boosting, a~takisto využíva aj regresných a~klasifikačných stromov. Dáta slúžiace na natrénovanie metód tvorí databáza ProTherm. Pre predikciu využíva informácie zo~susedných aminokyselín, konkrétne používa okno o~veľkosti 7 reziduí. Vektor vlastností tvorí 5 hodnôt, ktorými sú aminokyselina po mutácií, pôvodná aminokyselina, hodnota pH, teplota pri ktorej bola meraná stabilita a~informácie o~troch susedných reziduách. Nástroj je dostupný iba ako webový server \cite{iptree}.

\subsection{EASE-AA}

Nástroj ponúka predikciu vplyvu mutácie a~takisto určenie hodnoty $\Delta\Delta G$. Predikcia je založená iba na informáciách o~sekvencií. EASE-AA využíva informácie o~konzervovanosti, ktoré sú získané pomocou metódy SIFT. Konzerovanosť je vyjadrená pomocou tzv. SIFT skóre. Ďalej využíva štrukturálne informácie, kde patria sekundárna štruktúra, dostupná povrchová plocha (ASA), pravdepodobnosť poruchy (tzv. disorder probability) a~informácie o~vlastnostiach aminokyselín, ktoré tvorí 7 hodnôt vlastností. Vektor vlastností je vstupom pre metódu SVM tvoriacu základ nástroja, rovnako ako I-Mutant využíva jadrovú funkciu RBF. Nástroj je dostupný ako samostatná aplikácia \cite{ease}.
   
\subsection{mCSM}

Metóda identifikuje pre miesto mutácie všetky atómy v~zadanej vzdialenosti od geometrického stredu. Následne je uskutočnený výpočet vzdialenosti medzi jednotlivými atómami prostredia a~vygeneruje sa matica atómových vzdialeností. mCSM nakoniec vytvorí grafovo založené vzory atómových vzdialeností. Mutácia je reprezentovaná tzv. podpisovým vektorom, ktorý slúži na trénovanie a~testovanie metód strojového učenia. Nástroj je dostupný ako webová služba \cite{mcsm}.

\subsection{MAESTRO}

MAESTRO je multiagentný systém strojového učenia. K~predikcií využíva informácie o~sekvencií a~štruktúre spoločne s~2 štatistickými funkciami, slúži na predikciu jednobodových ale aj viacbodových mutácií. Systém využíva kombináciu neurónových sietí, SVM a~lineárnej regresie, ktoré sú natrénované na nezávislých dátach a~nakoniec sú ich výsledky spojené. Vstupným vektorom strojového učenia je 9 hodnôt, ktoré sú rozdelené na štatistické skórovacie funkcie a~vlastnosti proteínov, ako napríklad veľkosť proteínu. Špeciálnou vlastnosťou prediktoru je možnosť predikcie stabilizujúcich disulfidových mostíkov. Nástroj je dostupný ako samostatná aplikácia a~aj ako webový server \cite{maestro}.

\subsection{ELASPIC}

ELASPIC je nástroj využívajúci ensemble stratégie. Slúži na predikciu hodnoty $\Delta\Delta G$. Na začiatku nástroj predikuje proteínové domény a~ich interakcie a~detekuje proteínové jadrá. Mutácie sú mapované a~molekulárne, evolučné a~energetické vlastnosti sú určené na vytvorenie prediktívneho modelu využívajúceho rozhodovacie stromy s~algoritmom Stochaistic Gradient boosting. ELASPIC je dostupný ako samostatná aplikácia aj ako webový server \cite{elaspic}.

\section{Energetická funkcia - fyzikálny potenciál}

Nasledujúca sekcia obsahuje stručnú charakteristiku nástrojov využívajúcich k~predikcií fyzikálny potenciál.

\subsection{CC/PBSA}

Jedná sa o~štruktúrne založenú metódu pre rýchle a~kvantitatívne odhadnutie voľnej energie potrebnej k~zloženiu mutovaného proteínu. V~prvom kroku metóda uskutočňuje rýchle generovanie alternatívnych proteínových konformácií pomocou programu CONCOORD na navzorkovanie dostupného konfiguračného priestoru. Energetická funkcia založená na silových poliach a~riešenie Poisson-Boltzmannovej rovnice sú spriemerované nad vytvoreným celkom. Voľná energia je nakoniec aproximovaná ako suma elektrostatických interakcií, van der Waalsových energií a~zmenou entropie. Nástroj je dostupný ako webová služba \cite{ccpbsa}. 

\subsection{ERIS}

Nástroj ERIS je zložený na silovom poli Medusa a~pozostáva z~celoatómového silového poľa, algoritmu obaľovania bočného reťazca a~tzv. backbone relaxation metódy. Parametre silového poľa boli trénované s~vysokým rozlíšením proteínových štruktúr. ERIS je možné použiť ako webovú službu aj ako samostantý program \cite{eris}.

\subsection{Rosetta}

Rosetta predstavuje sadu softvéru na makromolekulárne modelovanie. Zahŕňa celú skupinu rôznych silových polí založených na kombinácií prispievateľov voľnej energie ako sú van der Waalsova energia alebo elektrostatické interakcie. Väčšina z~protokolov tohto nástroja je veľmi časovo náročná, a~preto je nástroj dostupný iba ako samostatná aplikácia \cite{rosetta}.

\subsection{CUPSAT}

Metóda je založená na výpočte atómových potenciálov a~potenciálov torzných uhlov, ktoré boli získané z~proteínových štruktúr pomocou webového serveru PISCES. Hodnoty Boltzmannovej energie sú vypočítané z~radiálnej párovej distribúcie atómov aminokyselín a~Gaussovská apodizačná funkcia je aplikovaná na priradenie výhodných energetických hodnôt pre susediace orientácie pozorovaných torzných uhlov. Nástroj je dostupný ako webová služba \cite{cupsat}.  

\section{Energetická funkcia - štatistický potenciál}

Nasledujúca sekcia obsahuje stručnú charakteristiku nástrojov využívajúcich k~predikcií štatistický potenciál.

\subsection{PopMuSiC}

Zmena stability danej bodovej mutácie je vypočítaná na základe štruktúry pôvodného nezmutovaného proteínu a~množine energetických funkcií. Hodnota $\Delta\Delta G$ je vyjadrená ako lineárna kombinácia 13 štatistických potenciálov. Nástroj je dostupný ako webová služba \cite{popmusic}.


\subsection{DMutant}

Nástroj DMutant využíva kombináciu orientácie na základe poznatkov, vzdialenostne závislý potenciál atómov aminokyselín a~potenciál torzného uhlu. Tieto časti tvoria diskriminačnú funkciu, ktorej parametre boli optimalizované trénovacou dátovou sadou. Nástroj je dostupný v~podobe samostatného programu \cite{dmutant}.

\subsection{FoldX}

Energetická funkcia nástroja zahŕňa požiadavky u~ktorých bolo zistené, že sú dôležité pre stabilitu. Patria tu van der Waalsovej príspevky, rozdiel solvatačnej energie alebo vodíkové väzby. Energetická funkcia je tvorená 8 časťami, ktoré sú nakoniec lineárne skombinované. Nástroj je dostupný ako samostatná aplikácia \cite{foldx}.


\chapter{Dátová sada a~jej parametre}

Vytvorenie spoľahlivej, dostatočne veľkej a~rozmanitej trénovacej dátovej sady je rozhodujúcou vlastnosťou pri tvorbe každého predikčného nástroja. Dáta pre testovanie a~trénovanie prediktoru boli z~veľkej časti získané z~databázy ProTherm \cite{protherm}. Jedná sa o~najrozsiahlejšiu databázu obsahujúcu termodynamické parametre akými sú Gibssova voľná energia, tepelná kapacita alebo entalpia. Databáza taktiež obsahuje informácie o~použitých metódach a~meraniach, experimentálnych podmienkach a~informácie o~aktivite proteínu, sekundárnej štruktúre a~dostupnosti pôvodných reziduí. ProTherm je prepojená aj s~ďaľšími databázami, napríklad so sekvenčnou SWISS--PROT \cite{swissprot}, štrukturálnou PDB \cite{pdb} alebo funkcionálnou PMD \cite{pmd}.


Databáza ProTherm bola naposledy aktualizovaná vo februári v~roku 2013 a~aktuálne obsahuje približne 26 000 záznamov jedno a~viacbodových mutantov navrhnutých nad viac ako 740 unikátnymi proteínmi získaných rôznymi experimentálnymi technikami. Pre tvorbu testovacích a~trénovacích dátových sád pre existujúce nástroje predikujúce vplyv aminokyselinových substitúcií na stabilitu proteínu je najpoužívanejším zdrojom dát práve databáza ProTherm. V~súčasnom stave však trpí množstvom serióznych nedostatkov. Aby sa predišlo problémom spojených s touto databázou, vyextrahované boli iba mutácie u~ktorých sú uvedené zmeny stability a~overené všetky zdroje. Najväčšími problémami pri získavaní dát boli:
\begin{itemize}
	\item Chýbajúca hodnota $\Delta\Delta G$
	\item Opačné znamienka hodnoty $\Delta\Delta G$ 
	\item Trojstavové skladanie - niektoré publikácie uvažujú 3 hodnoty Gibbsovej voľnej energie: nezložený stav, medzistav a~zložený stav. Databáza ProTherm však nerozlišuje medzi prechodom z~nezloženého stavu do medzistavu a z~medzistavu do zloženého stavu.
\end{itemize}

Aby bola vytvorená dátová sada spoľahlivá a~aby eliminovala možné experimentálne chyby v~nameraných hodnotách zmeny Gibssovej voľnej energie ($\Delta\Delta G$), záznamy s~hodnotami $\Delta\Delta G$ z~intervalu $\left[-0.5,0.5\right]$ boli odstránené. Záznamy s~hodnotou $\Delta\Delta G$ $\geq$ 0.5 $kcal.mol^{-1}$ boli označené za destabilizujúce a~záznamy s~$\Delta\Delta G$ $\leq$ -0.5~$kcal.mol^{-1}$ boli označené za stabilizujúce. Tento rozhodovací prah bol zvolený podľa tvrdenia, že experimentálna chyba merania $\Delta\Delta G$ je približne 0.48 $kcal.mol^{-1}$ \cite{threshold}.
V~prípade, že pre jednu mutáciu bolo uskutočnených viac meraní, ponechaný bol iba záznam merania, ktoré prebehlo pod experimentálnou hodnotou pH, ktorá bola blízko fyziologickej hodnote pH 7. Novovytvorená dátová sada je vytvorená z~celkovo 93 rôznych proteínov, u~niektorých je k~dispozícií jedna mutácia a u~iných je počet mutácií vyšší. Každý záznam mutácie v~proteíne bol ďalej rozšírený o~štrukturálne informácie, niektoré z~nich používajú pri predikcií aj iné nástroje.

\section{Parametre záznamu mutácie}

Každý záznam mutácie je tvorený z~8 hodnôt, ktoré tvoria vstupný vektor pre strojové učenie a~určenie vplyvu mutácie. Jedná sa o~parametre získané na základe informácií o štruktúre daného proteínu. V~tejto časti sú popísané jednotlivé parametre záznamu.

\begin{itemize}
	\item \textbf{Zmena polarity:} Tento údaj poskytuje informáciu o~zmene v~polarite aminokyseliny po mutácií oproti polarite pôvodnej aminokyseliny. Údaj bol získaný z~tabuľkových hodnôt pre skúmané aminokyseliny. Uvažované boli len polárne a~nepolárne aminokyseliny.
	\item \textbf{Zmena náboja}: Hodnota vyjadruje informáciu o~zmene náboja pôvodnej aminokyseliny a~aminokyseliny po mutácií. Výsledný údaj bol získaný z~tabuľkových hodnôt pre dané aminokyseliny. Uvažovaný bol negatívny, pozitívny a~neutrálny náboj. 
	\item \textbf{Zmena indexu hydrofobicity:} Údaj o~výslednej zmene hydrofobicity mutovanej a~pôvodnej aminokyseliny. Číselný údaj značí rozdiel medzi tabuľkovými hodnotami týchto porovnávaných aminokyselín \cite{hydrophobicity}. 
	\item \textbf{Zmena veľkosti aminokyseliny:} Údaj o~zmene veľkosti pôvodnej aminokyseliny. Aminokyseliny boli rozdelené do 3 intervalov na základe ich veľkosti. V~jednom intervale sa tak nachádzajú len aminokyseliny, pre ktoré platí, že rozdiel ich veľkostí je menší alebo rovný hodnote 50. Následne sa zisťovalo, do akého z~jednotlivých intervalov patrí pôvodná a~mutovaná aminokyselina. Z~tohto údaju bolo možné určiť zmenu veľkosti z~veľkej na malú, opačnú zmenu alebo žiadnu zmenu, ak aminokyseliny patrili do rovnakého intervalu.
	\item \textbf{Sekundárna štruktúra proteínu:} Údaj o~sekundárnej štruktúre proteínu bol získaný použitím modulu DSSP prítomného v~knižnici Biopython. Pre zjednodušenie bol každému proteínu priradený tento údaj len z~3 možností, ktorými sú helix, coil a sheet.
	\item \textbf{Dostupná povrchová plocha (ASA):} Jedná sa o~údaj, ktorý udáva plochu aminokyseliny, ktorú môže dosiahnuť rozpúšťadlo. Na výpočet tohto parametru bol opäť použitý modul DSSP prítomný v~knižnici Biopython.
	\item \textbf{Konzervovanosť:} Jeden z~najdôležitejších parametrov v~zázname mutácie. Informácia o~konzervovanosti pozície na ktorej došlo k~mutácií je reprezentovaná
	jednou z~5 hodnôt od 0 po 4, ktoré kódujú percentuálne vyjadrenie miery konzervovanosti danej pozície. Pri prvotnom výpočte tohto parametru bolo použité len viacnásobné zarovnanie získaných homológnych sekvencií, kde sa sledoval stĺpec s~mutáciou a~počítalo sa percentuálne zastúpenie pôvodnej aminokyseiny oproti novej. Neskôr bol ale zvolený postup výpočtu pomocou tvorby fylogentického stromu spoločne s~použitím Felsteinovho algoritmu, ktorý je podrobnejšie popísaný v~časti \ref{felstein}. Tento spôsob výpočtu je presnejší a~aj zvolený rozsah lešie vyjadruje konzervovanosť pozície. Mutácie na konzervovanej pozícií sú z~hľadiska skúmania veľmi zaujímavé, pretože konzervované aminokyseliny bývajú dôležité pre stabilitu, aktivitu, alebo schopnosť proteínu vytvoriť terciárnu štruktúru.
	\item \textbf{Korelácia:} Výpočet korelácie mutovanej pozície s~ostatnými pozíciami vo viacnásobnom zarovnaní. Stĺpec v~zarovnaní predstavuje náhodnú veličinu, počíta sa vzájomná informácia, ktorá vyjadruje závislosť dvojice náhodných veličín. Údaj o~vzájomnej informácií dostaneme pomocou nasledujúceho vzťahu: 	
	\begin{align}
	I(X;Y) = \underset{y \in Y}{\sum} \underset{x \in X}{\sum} p(x,y) \log_{2}\frac{p(x,y)}{p(x) p(y)}
	\end{align}  
	Po vypočítaní koeficientov sa zistí, či sa medzi získanými koeficientami nachádza aspoň jeden s~hodnotou nad stanoveným prahom. Ak áno, pozícia je korelovaná, v~opačnom prípade nie je. Korelácia danej pozície tiež znamená, že sa v~priebehu evolúcie menila spoločne s~pozíciami v~sekvencií, na ktorých boli získané korelačné koeficienty nad stanoveným prahom. 
	
\end{itemize}

\section{Felsteinov algoritmus}
\label{felstein}
Felsteinov algoritmus slúži na riešenie tzv. maličkého likelihood problému a~snahou je určiť tzv. likelihood hodnotu stromu pre zadanú pozíciu v~sekvencií. Vstupom je viacnásobné zarovnanie sekvencií, tvar stromu spoločne s~ohodnotením vnútorných uzlov a~dĺžka hrán. 
Algoritmus je založený na princípe dynamického programovania a~pozostáva z~viacerých krokov.
Prvým krokom je priechod stromom od listov ku koreňu a~vyhodnotenie L-hodnoty pre každý uzol podľa pravidiel, ktoré sú nasledovné:
\begin{itemize}
	\item listový uzol
	\begin{align}
	L_{s_{k}} (k) = \bigg\{_{1\quad k\ =\ nukleotid\ v\  liste}^{0\quad k\ \neq\ nukleotid\ v\  liste}
	\end{align}  
	
	\item vnútorný uzol
	\begin{align}
	L_{s_{k}} (k) = \Bigg[\underset{s_{i}}{\sum}P_{s_{k}s_{i}}(t_{i})\cdotp L_{s_{i}}(i)\Bigg] \times \Bigg[\underset{s_{j}}{\sum}P_{s_{k}s_{j}}(t_{j})\cdotp L_{s_{j}}(j)\Bigg]
	\end{align}
	
	\item koreňový uzol
	\begin{align}
	L = \underset{s_{0}}{\sum}\pi_{s_{0}} \cdotp L_{s_{0}}(0)
	\end{align} 

\end{itemize}

L-hodnota je uložená v~poli, ktoré obsahuje každý uzol stromu. V~tomto prípade každý uzol obsahuje pole s~váhami jednotlivých nukleotidov, ktoré sú počítané počas priechodu stromom. Pri použití algoritmu v~tejto práci obsahuje pole hodnoty s~váhami pre jednotlivé sekvencie vo viacnásobnom zarovnaní. Počas priechodu sa počítajú hodnoty v~poli každého uzlu a~výsledkom je pole obsiahnuté v~koreni stromu. Pole s~váhami sa použije na zistenie konzervovanosti konkrétnej pozície. Počítaním váh sa sledujú zmeny na pozícií v~priebehu evolúcie proteínu a~na základe koeficientov je vypočítaná konzervovanosť.

\chapter{Implementácia}
Finálnou časťou práce je implementácia predikčného nástroja. Táto kapitola bližšie popisuje výber použitých technológií, spôsob realizácie nástroja, dosiahnuté výsledky a~porovnanie finálnej implementácie s~podobnými nástrojmi.

\section{Testovanie vo WEKE}
\label{wekatest}
Výber vhodnej metódy strojového učenia na základe otestovania rôznych metód na zostavenej dátovej sade predstavoval prvú fázu pri tvorbe predikčného nástroja. Na otestovanie dátovej sady bol zvolený nástroj \texttt{WEKA}.

WEKA \cite{weka} predstavuje voľne dostupný balík algoritmov strojového učenia napísaného v~programovacom jazyku Java. Ide o~veľmi populárny nástroj určený na použitie v~akademickej ale aj komerčnej sfére. Nástroj poskytuje množstvo algoritmov strojového učenia, ktoré je možné rýchlo vyskušať a~porovnať na zvolenej dátovej sade; a~nástroje na predspracovanie analyzovaných dát. WEKA poskytuje algoritmy na regresiu, zhlukovanie, klasifikáciu, získavanie asociačných pravidiel a~výber atribútov.
Pred testovaním bola dátová sada prevedená do formátu ARFF, natívneho formátu nástroja. Nástroj ponúka nasledovné triedy algoritmov: Bayes, Functions, Lazy, Meta, Mi, Misc, Rules, Trees. Z~týchto tried bolo vybraných niekoľko algoritmov, ktoré sú bližšie popísané v kapitole \ref{ml}. Zvolené boli najmä rôzne stromové algoritmy a~rôzne verzie SVM. Pomocou týchto metód bola dátová sada otestovaná a~na základe výsledkov boli vybrané najlepšie metódy na ďaľšie použitie pri implementácií. Výsledky testovania obsahuje tabuľka \ref{testovanie}.

Testovanie zvolených metód bolo vykonané na celej dátovej sade, pri testovaní bola použitá krížová validácia a~testovacie dáta boli rozdelené do desiatich častí, pričom konečné výsledky sú spriemerované z~niekoľkých testovaní. Nastavená bola aj tzv. cost--sensitive matica, ktorá slúžila na postihovanie predikcie stabilizujúcich mutácií ako destabilizujúcich, pretože v~trénovacej sade je väčší počet destabilizujúcich mutácií ako stabilizujúcich a~poslúžila na vyvažovanie nerovnomerného počtu záznamov. Pri testovaných modeloch bolo odskúšaných niekoľko hodnôt parametrov, ktoré bolo možné meniť. Výsledky testovania jednotlivých metód sú v~tabuľke \ref{testovanie}. 

Tabuľka \ref{testovanie} obsahuje údaje TP (true positive) rate o~presnosti identifikácie stabilizujúcich a~destabilizujúcich položiek, ktoré sú skutočne stabilizujúce alebo destabilizujúce, FP (false positive) rate vyjadrenie presnosti určenia stabilizujúcej mutácie ako destabilizujúcej a~naopak. Posledným údajom je celková presnosť metódy pri predikcií na testovacej podsade. Na základe tohto údaju boli vybraté najlepšie metódy.

\begin{table}[H]
	\centering
	\begin{tabular}{ | l | c | c | c| }
		\hline 
		Metóda strojového učenia & TP rate & FP rate & Accuracy \\ \hline
		Naive Bayes & 0.776 & 0.626 & 0.737 \\ \hline
		LibSVM &  0.786   & 0.706   & 0.766  \\ \hline
		SMO & 0.774 & 0.774 & 0.6\\ \hline
		DecisionTable & 0.774 & 0.774 & 0.6\\ \hline
		RandomForest & 0.793 & 0.692 & 0.797\\ \hline
		RandomTree & 0.793 & 0.574 & 0.766\\ \hline
		J48 & 0.774 & 0.626 & 0.74\\ \hline		
	\end{tabular}
	\caption {Výsledky testovanie algoritmov strojového učenia} \label{testovanie} 
\end{table}

Z~tabuľky \ref{testovanie} je vidieť, že z~metód založených na rozhodovacích stromoch dosiahla najlepšie výsledky metóda Random Forest a z~metód implementujúcich SVM mala najlepší výsledok metóda LibSVM. Obidve metódy dosiahli presnosť vyššiu ako 70\%. V~prípade SVM mal druhý algoritmus SMO horšie výsledky. Metóda Naive Bayes založená na bayesovskej pravdepodobnosti dosiahla len o~niečo horšie výsledky ako zvyšné metódy. Potvrdili sa však očakávania dobrých výsledkov algoritmu Random Forest aj SVM, a~preto boli tieto metódy určené ako základ vytváraného ensemble systému predikčného nástroja.

\section{Príprava záznamu mutácie v Pythone}

Na implementáciu predikčného nástroja bol zvolený programovací jazyk \texttt{Python}, najmä kvôli dostupnosti mnohých bioinformatických nástrojov a~knižníc, ale aj pre jednoduché implementovanie strojového učenia vďaka dostupným knižniciam. Program má charakter konzolovej aplikácie ovládanej z~príkazového riadku s~niekoľkými vstupnými parametrami od užívateľa.

Prvou fázou pri tvorbe nástroja bola implementácia skriptu s prípravou záznamu reprezentujúceho jednu mutáciu, ktorý tvorí vstup pre strojové učenie. Príprava záznamu zahŕňa výpočet jednotlivých parametrov mutácie a~celkovo pozostáva z~výpočtu 8 hodnôt. Výsledný záznam má podobu CSV súboru s~jednotlivými parametrami.

Pre výpočet hodnôt zmien náboja, polarity, indexu hydrofobicity a~veľkosti aminokyseliny sú v~príslušnej triede prítomné dátové štruktúry obsahujúce hodnoty náboja, polarity, indexu hydrofobity a~veľkosti pre jednotlivé aminokyseliny. Hodnoty parametrov sa vypočítajú na základe zmeny podľa určenia pôvodnej aminokyseliny a~aminokyseliny po mutácií.

Výpočet údajov o~sekundárnej štruktúre proteínu a~hodnote dostupnej povrchovej plochy (ASA) prebieha spoločne. Na ich výpočet bola použitá knižnica \texttt{Biopython} \cite{biopython}, konkrétne modul DSSP. Pomocou neho je možné získať obidva údaje z~PDB súboru. Pre správne fungovanie modulu je však nutné mať prítomný samostatný program {\tt dssp} \cite{dssp}, ktorý modul používa na výpočet.

Proces výpočtu konzervovanosti mutovanej pozície je o~niečo zložitejší ako ostatné výpočty. Vstupom výpočtu je \texttt{FASTA} súbor so sekvenciou požadovaného typu reťazca a~PDB súbor. \texttt{FASTA} súbor slúži ako vstup programu {\tt BLAST} \cite{blastp}, ktorý bol použitý na získane homológnych sekvencií, zvolená bola hodnota 250 sekvencií. Výstup v~podobe XML súboru je spracovaný do podoby textového súboru slúžiaceho ako vstup programu {\tt Clustal Omega} \cite{clustal}, ktorý vytvára viacnásobné zarovnanie vstupných sekvencií.
PDB súbor je určený na získanie počiatočnej pozície rezidua, ktorá spoločne s~indexom mutácie slúži na získanie výsledného indexu mutácie vo viacnásobnom zarovnaní. Výpočet je založený na vytvorení fylogenetického stromu a~použití Felsteinovho algoritmu. Na vytvorenie koreňového stromu je použitý program {\tt FastTree} \cite{fasttree}. Na implementáciu fylogenetického stromu v~Pythone bola použitá knižnica {\tt ete3}\footnote{Dostupné na \url{http://etetoolkit.org/}}, ktorá využíva na zostavenie stromu výstup programu \texttt{FastTree}. Pri použití Felsteinovho algorimu bolo potrebné poznať aj ohodnotenie prechodov medzi jednotlivými aminokyselinami. Na tento účel bolo použitá matica prechodov BLOSUM62, ktorá je zostavená dynamicky v~programe z~textového súboru, takže je možné použiť aj súbor s~inou maticou.
Výsledné váhy získané Felsteinovým algoritmom spoločne s~viacnásobným zarovnaním slúžia na konečný výpočet konzervovanosti, ktorá je rozdelená do 5 úrovní.

Posledným parametrom je určenie korelácie mutovanej pozície. Na výpočet je opäť použité viacnásobné zarovnanie sekvencií. Jednotlivé hodnoty parametov, ktoré nemajú číselnú hodnotu výstupu, sú nakoniec zakódované do svojej číselnej reprezentácie, aby s~nimi mohla pracovať metóda strojového učenia.

\section{Testovanie metód strojového učenia v Pythone}

Ďaľšou fázou tvorby nástroja bola implementácia metód strojového učenia. Na implementáciu jednotlivých algoritmov som zvolil knižnicu {\tt Scikit-learn} \cite{scikit-learn}. Scikit-learn je knižnica strojového učenia pre programovací jazyk Python a~zahŕňa v~sebe rozličné klasifikátory, zhlukovacie algoritmy ako napríklad support vector machines, random forests a~gradient boosting.

Podľa výsledkov testovania rôznych metód uvedených v~časti \ref{wekatest} dosiahli najlepšie výsledky metódy SVM a~Random Forest. Na začiatku tejto fázy vývoja som otestoval implementácie týchto metód z~knižnice Scikit-learn na dátovej sade, z~ktorej boli odstránené záznamy slúžiace ako testovacie dáta. Testovacia sada obsahuje 250 záznamov a~bola vytvorená náhodným výberom z~pôvodnej sady. Je tvorená zo 45 stabilizujúcich mutácií a~206 destabilizujúcich mutácií. Trénovacia sada obsahuje 1315 záznamov. Výsledky testovania sú reprezentované dvomi hodnotami, presnosťou (accuracy) a~hodnotou korelácie vyjadrenej Matthewsovým korelačným koeficientom (MCC). Výsledky testovania sú prítomné v~tabuľke \ref{scikittest}.
\begin{table}[H]
	\centering
	\begin{tabular}{ | l | c | r | l| }
		\hline 
		Metóda  & Accuracy & MCC \\ \hline
		Random Forest & 0.712 & 0.34\\ \hline
		SVM & 0.813 & 0.36 \\\hline
	\end{tabular}
	\caption {Výsledky testovanie algoritmov z~knižnice Scikit-learn} \label{scikittest} 
\end{table}

Tabuľka \ref{scikittest} ukazuje, že v~presnosti dosiahla metóda SVM veľmi dobré výsledky, presnosť bola 81\%. Metóda Random Forest dosiahla presnosti približne 71\%. Obe metódy dosiahli podobných výsledných hodnôt Matthewsovho korelačného koeficientu, SVM dosiahla hodnoty 0.36 a Random Forest 0.34. Pri testovaní metódy SVM bolo použitých niekoľko jadrových funkcií a~najlepšie výsledky dosiahla polynomiálna jadrová funkcia. Hodnota MCC je pre vyhodnotenie metódy smerodatnejšia a~vyjadruje vzťah predikovaných a~skutočných hodnôt. Dosiahnuté hodnoty korelácie budú slúžiť na porovnanie výsledkov samostatne použitej metódy a~vytvoreného ensemble systému.

\newpage
\section{Ensemble systém v Pythone}

Základom ensemble systému je použitie viacerých klasifikátorov a~spojenie ich výsledkov. Pred natrénovaním jednotlivých metód bolo potrebné zostaviť trénovacie dáta pre tento systém. Vytvorenie dát spočívalo vo vytvorení menších podsád z~pôvodnej sady. Na ich vytvorenie som využil techniku bagging s~prekryvom dát v~podsadách. Na zostavenie podsád bola použitá sada 1315 záznamov z~predchádzajúceho testovania. Celkovo bolo vytvorených 14 trénovacích podsád, ktoré boli najskôr samostatne otestované na jednotlivých metódach. 
  
\begin{table}[H]
	\centering
	\begin{tabular}{ |l | c | c | c | c|}
		\hline 
		Dátová sada & Stabilizujúce záznamy & Destabilizujúce záznamy & MCC (SVM) & MCC (RF)  \\ \hline
	1. & 100 & 100 & 0.4 & 0.25\\ \hline
	2. & 100 & 150 & 0.42 & 0.29\\ \hline
	3. & 130 & 100 & 0.36 & 0.24\\ \hline
	4. & 150 & 100 & 0.41 & 0.31\\ \hline
	5. & 150 & 150 & 0.43 & 0.3\\ \hline
	6. & 150 & 200 & 0.45 & 0.34\\ \hline
	7. & 200 & 150 & 0.41 & 0.29\\ \hline
	8. & 200 & 200 & 0.43 & 0.34\\ \hline
	9. & 200 & 250 & 0.52 & 0.29\\ \hline
	10. & 200 & 250 & 0.48 & 0.32\\ \hline
	11. & 250 & 200 & 0.53 & 0.37\\ \hline
	12. & 250 & 200 & 0.47 & 0.34\\ \hline
	13. & 250 & 250 & 0.47 & 0.34\\ \hline
	14. & 250 & 250 & 0.48 & 0.29\\ \hline
	\end{tabular}
	\caption {Výsledky testovania podsád metódami Random Forest a SVM} \label{pythontest} 
\end{table}

Tabuľka \ref{pythontest} ukazuje výsledky testovania jednotlivých podsád na vybraných metódach. Ako je možné vidieť, niektoré veľkosti podsád sa opakujú a to z dôvodu obmeny záznamov v~týchto sadách a~zaistenia väčšieho rozptylu u~destabilizujúcich záznamov. Podsady boli testované s~prítomnosťou všetkých parametrov, v~ďaľšom testovaní došlo k~odstráneniu niektorých parametrov, cieľom bolo zistiť ako takéto kombinácie parametrov budú pôsobiť na predikciu. Vytvorené podsady boli otestované bez parametra zmeny náboja, veľkosti dostupnej povrchovej plochy a~kombinácií parametrov zmeny indexu hydrofobicity a~dostupnej povrchovej plochy. Výsledky testovania sú uvedené v~tabuľke \ref{pythontest1}.

\begin{table}[H]
	\centering
	\begin{tabular}{|l |c |c |c |c |c |c|}
	\hline
	Dataset & \multicolumn{3}{c|}{MCC (SVM)} & \multicolumn{3}{c|}{MCC (RF)} \\ \cline{1-7}
	\hline 
	1. & 0.3 & 0.27 & 0.32 & 0.17 & 0.2 & 0.2 \\ \cline{1-7} 
	2. & 0.31 & 0.33 & 0.4 & 0.19 & 0.25 & 0.21\\ \cline{1-7} 
	3. & 0.28 & 0.4 & 0.38 & 0.18 & 0.2 & 0.13 \\ \cline{1-7}
	4. & 0.36 & 0.36 & 0.39 & 0.21 & 0.29 & 0.22 \\ \cline{1-7}
	5. & 0.41 & 0.42 & 0.41 & 0.23 & 0.28 & 0.24\\ \cline{1-7}
	6. & 0.44 & 0.41 & 0.4 & 0.29 & 0.3 & 0.25\\ \cline{1-7}
	7. & 0.4 & 0.29 & 0.39 & 0.28 & 0.26 & 0.3\\ \cline{1-7}
	8. & 0.47 & 0.36 & 0.42 & 0.29 & 0.28 & 0.29\\ \cline{1-7}
	9. & 0.45 & 0.36 & 0.41 & 0.26 & 0.27 & 0.31\\ \cline{1-7}
	10.& 0.36 & 0.42 & 0.46 & 0.28 & 0.29 & 0.32\\ \cline{1-7}
	11.& 0.43 & 0.39 & 0.42 & 0.32 & 0.32 & 0.27\\ \cline{1-7}
	12.& 0.44 & 0.4 & 0.43  & 0.31 & 0.33 & 0.32\\ \cline{1-7}
	13.& 0.41 & 0.36  & 0.41 & 0.28 & 0.27 & 0.33\\ \cline{1-7}
	14.& 0.44 & 0.42 & 0.44 & 0.3 & 0.28 &  0.31\\ \cline{1-7}
	\hline
	\end{tabular}
\caption {Výsledky testovania podsád bez parametra dostupnej povrchovej plochy, zmeny náboja a~kombinácie zmeny indexu hydrofobicity a~dostupnej povrchovej plochy.} 
\label{pythontest1} 
\end{table}


Tabuľka \ref{pythontest1} ukazuje výsledky testovania podsád bez odstránených parametrov. Testovania so všetkými parametrami ale aj s~odstránenými slúžili na získanie údaju o~korelačnom koeficiente. Na základe získaných údajov boli vybrané podsady s~najlepšími výsledkami. Tieto podsady sú základom ensemble systému a~každá z~nich slúži na natrénovanie jednej metódy strojového učenia.

Implementovaný ensemble systém pozostáva so spojenia metód Random Forest a~SVM, konkrétne bola metóda Random Forest natrénovaná trikrát a~metóda SVM štyrikrát. Model metódy SVM využíva polynomiálnu jadrovú funkciu, vo všetkých testovanich dosiahla najlepšie výsledky. Ide o~funkciu druhého stupňa, s~pribúdajúcimi stupňami sa rýchlosť predikcie len zvyšovala ale nebolo viditeľné výrazné zlepšenie výsledkov. Každou predikciou bol získaný údaj o~výslednej triede, nakoniec bolo k~dispozícií sedem hodnôt predikovanej triedy pre mutáciu. Výsledná hodnota predikovanej triedy bola získaná hlasovaním väčšiny, výsledkom bola trieda, ktorá sa medzi hodnotami nachádzala častejšie.

Ensemle systém bol vo finálnej implementácií natrénovaný na podsadách č. 8, 9, 11, 14. Metóda Random Forest bola natrénovaná na podsadách č. 8, 11, 13 so všetkými parametrami. Metóda SVM bola natrénovaná na podsade č. 9, 11 a 14 so všetkými parametrami a~podsade č. 8 bez parametra dostupnej povrchovej plochy. Finálna hodnota korelačného koeficientu na testovacej sade dosiahla hodnotu 0.55. 

\begin{figure}[H]
	\centering
	\begin{center}
		\scalebox{0.6}
		{   
			\includegraphics{mcc.png}
		}
		\caption{Graf s~porovnaním hodnôt MCC na testovacej sade.}
	\end{center}
\end{figure}

\section{Porovnanie s inými nástrojmi}

Po implementovaní prediktora som pristúpil k~porovaniu predikčnej sily s~niekoľkými dostupnými nástrojmi. Tieto nástroje boli zvolené podľa toho, či boli otestované na testovacej sade S350 \cite{S350}, ktoré mnohé nástroje používajú ako svoju testovaciu sadu. Táto sada obsahuje 350 záznamov mutácií, z~ktorých je 95 stabilizujúcich a~255 destabilizujúcich. 
Porovnávanie spočívalo v~otestovaní implementovaného prediktora na sade S350 a~porovnaní výsledkov s~nástrojmi, ktoré boli otestované na tejto sade. Daný postup bol zvolený najmä preto, že natrénovanie a~otestovanie iných nástrojov na vytvorenej dátovej sade by nebolo úplne možné, pretože mnoho nástrojov je dostupných len v~podobe webovej aplikácie.

Zo sady S350 neboli odstránené záznamy s~hodnotou $\Delta\Delta$G v~intervale $\left[-0.5,0.5\right]$, ktoré sa v~dátovej sade nevyskytujú. Záznamy s~týmito hodnotami boli ponechané, pretože bez nich by porovnanie nebolo uskutočnené na rovnakej dátovej sade. Každému záznamu bolo dodatočne nutné určiť príslušnú triedu, pretože sada obsahuje iba hodnotu $\Delta\Delta$G. Rozhodovacia hranica bola stanovená tak, že mutácie s~$\Delta\Delta$G $>= 0$ boli označené ako stabilizujúce a~zvyšné mutácie ako destabilizujúce. Hranice sú naopak oproti dátovej sade, upravené boli po dodatočnom skúmaní sady S350. 


\begin{figure}[H]
	\centering
	\begin{center}
		\scalebox{0.7}
		{   
			\includegraphics{porovnanie_nastrojov.png}
		}
		\caption{Graf s~porovnaním hodnôt MCC vybraných nástrojov}
		\label{porovnanie}
	\end{center}
\end{figure}

Graf na obrázku \ref{porovnanie} ukazuje porovnanie hodnôt korelačného koeficientu u~rôznych nástrojov na sade S350. Z~grafu vidieť, že najlepšiu hodnotu dosiahol nástroj FoldX, ktorý patrí do kategórie nástrojov využívajúcich štatistický potenciál. Medzi ďaľšie nástroje s~vysokou hodnotou korelácie patria nástroje PoPMuSiC rovnako patriaci do kategórie nástrojov využívajúcich štatistický potenciál a~nástroj Rosetta využívajúci fyzický potenciál. Všetky uvedené nástroje dosiahli koreláciu väčšiu ako 0.3, pričom medzi najlepšie nástroje zo všetkých uvedených patrí Rosetta.

Zvyšné zvolené prediktory dosiahli menšiu hodnotu korelácie, najlepšie výsledky z~nich dosiahli nástroje SDM \cite{sdm}, CUPSAT a Eris. SDM predstavuje nástroj založený na získavaní znalostí, CUPSAT využíva na výpočet potenciál atómov a~torzných uhlov, Eris využíva fyzický potenciál. Zostávajúcimi nástrojmi sú I-Mutant3 a~MuPro \cite{mupro}. Obidva uvedené nástroje zhodne využívajú strojové učenie a~konktrétne metódu SVM.
 
U~mnohých ďaľších nástrojov je problém v~získaní údajov o~použitej dátovej sade na trénovanie a~rovnako spôsob validácie nástroja, takže ich nie je možné brať do úvahy pri porovnávaní nástrojov.

Pri porovnaní implementovaného nástroja s~inými nástrojmi využívajúcimi strojové učenie je vidieť, že implementovaný prediktor využívajúci ensemble prístup dosiahol lepšej korelácie ako nástroje I-Mutant3, MuPro, DMutant, CUPSAT a~Eris. Korelácia nástroja I-Mutant3 dosiahla hodnotu 0.14, MuPro dosiahol korelácie 0.18, DMutant dosiahol hodnoty 0.12. CUPSAT a~Eris mali najlepšie hodnoty, CUPSAT 0.24 a~Eris 0.3. Implementovaný prediktor dosiahol na dátovej sade S350 koreláciu 0.3, čo je v~porovaní s týmito hodnotami zlepšenie o~0.16, 0.12, 0.18, 0.06 a~pri Erise boli dosiahnuté hodnoty totožné.

Výsledky ensemble systému boli porovnané aj s hodnotami dosiahnutými použitím samostatných metód Random Forest a SVM. Samotný Random Forest dosiahol na sade S350 koreláciu 0.26 a SVM 0.28.

Prediktor dosiahol hodnotu korelácie 0.3, čo spomedzi testovaných nástrojov predstavuje dobrú hodnotu, podobnú testovaným. Najlepšie výsledky pri predikcií však dosahujú nástroje založené na využití štatistického alebo fyzického potenciálu, aj keď hodnota MCC nie je najvyššia.

\chapter{Záver}

Hlavnou náplňou tejto práce bolo vytvorenie predikčného nástroja využívajúceho metódy strojového učenia, ktorý by určoval vplyv aminokyselinových mutácií na stabilitu proteínu.

Keďže ide o~predikčný nástroj, v~prvom kroku bolo potrebné získať dáta určené na trénovanie a~testovanie nástroja. Zostavený dataset obsahuje 1564 jednobodových mutácií získaných z~databázy \textit{ProTherm}. Jedná sa o~unikátny dataset, očistený od mutácií obsahujúce rôzne nedostatky pri uvádzaných hodnotách mutácií. Každá mutácia je doplnená o~8 parametrov určených k vytvoreniu rozhodovacej hranice.

V~nasledujúcom kroku bolo potrebné zvoliť metódy strojového učenia. Pomocou nástroja WEKA bolo na zostavenom datasete odskúšaných viacero dostupných metód a~nakoniec boli vybrané metódy Random Forest a~SVM. Tieto metódy sa stali základom implementovaného ensemble systému.

Nástroj obsahuje ensemble systém kombinujúci metódy Random Forest a~SVM na predikciu výsledného vplyvu mutácie. Zvolený prístup slúži na vysporiadanie sa s~menším množstvom dát a~rovnako na zlepšenie robustnosti predikcie. 
Na vytvorenie ensemble stratégie bolo potrebné vytvoriť menšie podsady, ktoré slúžili na natrénovanie jednotlivých metód. Takýto prístup predikcie dosiahol na testovacej dátovej sade o~veľkosti 250 mutácií vytvoreného z~pôvodnej dátovej sady hodnotu korelačného koeficientu 0.55. Oproti použitiu samostanej metódy Random Forest, ktorá dosiahla na zostavenej sade koreláciu 0.34 alebo metóde SVM s~koreláciou 0.36 ide o~značné zlepšenie tejto hodnoty.

Na záver bol nástroj porovnaný s~vybranými nástrojmi na testovacej sade mutácií S350. Na tejto sade dosiahol prediktor hodnotu korelačného koeficientu 0.3 a~presnosť dosiahla 67\%.

Návrhom zlepšenia predikčného nástroja je určite získanie väčšieho množstva relevantných dát, čo ale v~dnešnej dobe nie je jednoduché, pretože databáza \textit{ProTherm} obsahuje rôzne nedostatky a~dáta nepribúdajú dostatočne rýchlo. 
Ďaľším návrhom je možnosť zvolenia iných parametrov pre predikciu, ktoré by mohli mať dôležitý vplyv na stabilitu, alebo zlepšenie ich výpočtu. V~rámci zlepšenia výpočtu bolo v~tejto práci implementované vylepšenie určenia konzervovanosti pomocou zostavenia fylogenetického stromu a~použitia Felsteinovho algoritmu.

%=========================================================================
